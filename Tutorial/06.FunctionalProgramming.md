### 函数式编程（Functional Programming）

函数是Python内建支持的一种封装，通过一层一层的函数调用，就可以吧复杂任务分解成简单任务，这种分解成为面向过程的程序设计。

函数就是面向过程的程序设计的基本单元。

函数式编程是一种抽象程度很高的编程范式，纯粹的函数式编程语言编写的函数没有变量，因此，任意一个函数，只要输入是确定的，输出就是确定的，这种纯函数成为没有副作用。而允许使用变量的程序设计语言，函数内部的变量状态不确定，同样的输入，可能得到不同的输出，这种函数是有副作用的。

函数式编程的一个特点是，允许把函数本身作为参数传入另一个函数，还允许返回一个函数。

Python对函数式编程提供部分支持，但不是纯函数式编程。

#### 高阶函数

1. 介绍

    `Higher-order function`

    变量可以指向函数名

    函数名也是变量

    传入函数

    一个函数可以接收另一个函数作为参数，这种函数成为高阶函数。

2. map/reduce

    `map()`接受2个参数，一个是函数，一个是`Iterable`，`map`将传入的函数依次作用于序列的每个元素，并把结果集作为新的`Iterator`返回。

    `reduce()`，接收两个参数，一个是函数，一个是`Iterable`，函数必须要接收两个参数，`reduce`把结果继续和序列的下一个元素做累积计算。
    效果。

    `reduce`需要先引入

```
from functools import reduce
reduce(f, [x1, x2, x3, x4]) = f(f(f(x1, x2), x3), x4)
```

3. filter

    `filter()`也接收一个函数和一个序列。和`map()`不同的是，`filter()`把传入的函数依次作用于每个元素，然后根据返回值是`True`还是`False`决定保留还是丢弃该元素。

```
# 求素数  埃氏筛法
# （1）先把1删除（现今数学界1既不是质数也不是合数）
# （2）读取队列中当前最小的数2，然后把2的倍数删去
# （3）读取队列中当前最小的数3，然后把3的倍数删去
# （4）读取队列中当前最小的数5，然后把5的倍数删去
# （5）读取队列中当前最小的数7，然后把7的倍数删去
# （6）如上所述直到需求的范围内所有的数均删除或读取

# 定义从3开始的奇数列

def _odd_iter():
    n = 1
    while True:
        n = n + 2
        yield n

# 定义筛选函数


def _not_divisible(n):
    return lambda x: x % n > 0

# 定义生成器，不断返回下一个素数

def primes():
    n = 2
    yield n
    it = _odd_iter()

    while True:
        n = next(it)
        yield n
        it = filter(_not_divisible(n), it)
```

4. sorted()

```
sorted(Iterator,key=function,reverse=False)
```

用sorted()排序的关键在于实现一个映射函数

#### 返回函数

函数作为结果值返回。

返回的函数在其定义内部引用了局部变量args，所以，当一个函数返回了一个函数后，其内部的局部变量还被新函数引用

返回闭包时牢记一点：返回函数不要引用任何循环变量，或者后续会发生变化的变量。

如果一定要引用循环变量怎么办？方法是再创建一个函数，用该函数的参数绑定循环变量当前的值，无论该循环变量后续如何更改，已绑定到函数参数的值不变：
